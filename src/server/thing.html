<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>MathLive Scratchpad</title>

    <!-- MathLive -->
    <script src="https://unpkg.com/mathlive"></script>

    <style>
        body {
            font-family: system-ui, sans-serif;
            padding: 2rem;
            background-color: #000;
        }

        math-field {
            width: 100%;
            min-height: 3rem;
            font-size: 1.5rem;
            border: 1px solid white;
            border-radius: 6px;
            padding: 0.5rem;

            background-color: black;
            color: white;   
            caret-color: white;

            --contains-highlight-background-color: transparent;
            --placeholder-color: transparent;

        }
    </style>
</head>

<body>

    <math-field id="mf" default-mode="display" smart-superscript="false" value="\displaylines{}"></math-field>
    <math-field id="interface" default-mode="text" smart-superscript="false"></math-field>
    <script>
        const mf = document.getElementById("mf")
        const interface = document.getElementById("interface")
        const ws = new WebSocket(`wss://${window.location.host}/proxy/3001`)
        alert(`wss://${window.location.host}/proxy/3001/`)
        ws.addEventListener("message", event => {
            const data = JSON.parse(event.data)
            switch(data.type) {
                case "set": {
                    mf.latex = data.payload
                }
            }
        })


        interface.addEventListener("input", event => {
            if (event.inputType === "insertLineBreak") {
                ws.send(JSON.stringify({
                    "type": "command",
                    "command": interface.value,
                    "payload": mf.value
                }))
                interface.value = ""
            }
        })


    </script>

</body>

</html>